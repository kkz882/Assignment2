<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Search</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .product {
      margin-bottom: 15px;
      padding: 10px;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>

  <h1>Search Products</h1>

  <!-- 搜索框 -->
  <input type="text" id="searchInput" placeholder="Enter product name">
  <button onclick="searchProducts()">Search</button>

  <!-- 显示产品的区域 -->
  <div id="productsContainer"></div>

  <script>
    // 使用 Fetch API 与后端进行交互
    async function searchProducts() {
      const keyword = document.getElementById('searchInput').value;  // 获取用户输入的搜索词
      const productsContainer = document.getElementById('productsContainer'); // 显示产品的容器

      if (!keyword) {
        productsContainer.innerHTML = "Please enter a product name to search.";
        return;
      }

      try {
        // 向后端 API 发送 GET 请求，查询产品
        const response = await fetch(`/api/products?name=${keyword}`);

        // 如果返回的是一个错误的响应
        if (!response.ok) {
          throw new Error('Error fetching products');
        }

        // 解析返回的 JSON 数据
        const products = await response.json();

        if (products.length === 0) {
          productsContainer.innerHTML = "No products found.";
        } else {
          // 清空显示区域
          productsContainer.innerHTML = '';

          // 显示产品列表
          products.forEach(product => {
            const productDiv = document.createElement('div');
            productDiv.classList.add('product');
            productDiv.innerHTML = `
              <h3>${product.name}</h3>
              <p>${product.description}</p>
              <p>Price: $${product.price}</p>
              <p>Category: ${product.category}</p>
            `;
            productsContainer.appendChild(productDiv);
          });
        }

      } catch (error) {
        productsContainer.innerHTML = "An error occurred while fetching products.";
        console.error(error);
      }
    }
  </script>

</body>
</html>
